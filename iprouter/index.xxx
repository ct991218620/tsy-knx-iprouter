<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>TSY KNX IP Router</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
	  <style>
  .center{
		margin: 0 auto;
		width: 1000px;
	}
   .lipadding{
	    padding-left: 20px;
   }  
		  
 </style>

  </head>

  <body>
  <nav class="navbar-dark bg-dark" >
  <div class="center">
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark" > <a class="navbar-brand"  href="#">TSY KNX IP Router</a>
  </nav>
	  </div>
	  </nav>
	   <div class="center">
	<div class="container" style="padding: 20px;">
      <div class="form-signin" style="width: 400px; text-align: left">
	    <div class="form-group">
	    <h3 class="form-signin-heading">欢迎使用TSY KNX IP Router</h3>
        <h5 class="form-signin-heading">请登录</h5>
		</div>
		 <div class="form-group">
        <label for="inputEmail" class="sr-only">user name</label>
        <input type="text" id="username" class="form-control lipadding" placeholder="用户名" required autofocus>
		</div>
		 <div class="form-group">
        <label for="inputPassword" class="sr-only">Password</label>
        <input type="password" id="Password" class="form-control lipadding" placeholder="密码" required>
        <div class="checkbox">
       <!-- <label>
            <input type="checkbox" value="remember-me"> 记住密码
        </label>-->
        </div>
	    </div>
        <button id="subsmit" class="btn btn-primary">登录</button>
      </div>
    </div> <!-- /container -->
  <div class="modal fade" id="exampleModal1"  data-backdrop="static" aria-hidden="true">
	  <div class="modal-dialog modal-dialog-centered modal-sm">
		<div class="modal-content" id="resetsuremod">
		  <div class="modal-body" style="text-align:center;margin-top:10;padding-top:10">
			<h5 >用户名或密码错误</h5>
		  </div>
		  <div style="text-align: center">
			<button type="button" class="btn btn-primary" style="margin:10px" data-dismiss="modal">确定</button>
		  </div>
		</div>
	
	</div>
</div>
    
     <hr style="border:none;border-top:1px solid #ADABAB;">
     <a href="" style="padding: 0px;">Powered by Tesiyun Electronics / Copyright (c) 2020 Tesiyun Electronics All rights reserved</a>     
  </div>
<script src="js/jquery.bootstrap.cookie.js"></script> 
<!--<script src="js/jquery.cookie.min.js"></script>-->

  </body>
	<script>
	//	$.base64.utf8encode = true;
		function submit(){
		   $.removeCookie('key',{path:'/'});
		//	var encode= $.base64.btoa($("#username").val()+":"+$("#Password").val());
		//	console.log(encode);
		   var data={};
		   var key1 = "username";
		   var val1=$("#username").val();
		   var key2 = "password";
		   var val2=$("#Password").val();
		   data[key1] = val1;
		   data[key2] = val2;
		   console.log(data);
			$.post("/cgi-bin/login",data,function(result){
				console.log(result);
				 var ret = JSON.parse(result);
			if(ret.status==1){
				var date = new Date(); 
				var minutes = 30; 
				date.setTime(date.getTime()+(minutes * 60 * 1000));
				$.cookie("key",ret.key,{expires:date}, {path:'/'});
				window.location.href="/status.html";	
			}else{
					console.log("password error");
				$('#exampleModal1').modal('show');
			}
		   
		});
			
		}
		 $('#subsmit').click(function(){
                  submit();
		 });
		$("#username,#Password").keypress(function (even) {
			if (even.which == 13) {
				submit();
				}
		});  
	    $.removeCookie('key',{path:'/'});
		
	</script>
</html>
